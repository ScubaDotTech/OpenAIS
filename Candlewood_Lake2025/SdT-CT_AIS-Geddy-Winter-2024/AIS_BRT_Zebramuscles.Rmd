Geddy Lucier
3/18/19
Cleaning and Incorporation of Zebra Muscle Data 

Preamble
```{r}
library(tidyverse)
library(sf)
library(terra)
library(readxl)
library(ggplot2)
library(ggforce)
library(stringr)
library(cowplot)
library(dplyr)
library(gbm)

zebra <- st_read("/Users/geddylucier/Documents/GitHub/LakeCandlewood/Candlewood_Lake2025/SdT-CT_AIS-Geddy-Winter-2024/zebra_search_area.kml")

zebra_base <- data.frame(zebra)

```
Cleaning Initial Dataset
```{r}


zebra_base <-  zebra_base %>%
  mutate(year = case_when(
     str_detect(Name, "2021") ~ 2021, 
    str_detect(Name, "2022") ~ 2022,
    TRUE ~ 2021),
    zeb_msc = str_extract(Name, " [:digit:]"),
    zeb_msc = ifelse(is.na(zeb_msc), 1, zeb_msc)
 
    
     )
#extract zebra lines and point data 
zebra_points <- zebra[st_geometry_type(zebra) == "POINT", ]
zebra_points$longitude <- st_coordinates(zebra_points)[,1]
zebra_points$latitude  <- st_coordinates(zebra_points)[,2]

zebra_lines <- zebra[st_geometry_type(zebra) == "LINESTRING", ]
zebra_lines$centroid <- st_centroid(zebra_lines$geometry)
zebra_lines$longitude <- st_coordinates(st_centroid(zebra_lines$geometry))[,1]
zebra_lines$latitude  <- st_coordinates(st_centroid(zebra_lines$geometry))[,2]

zebra_lines <- zebra_lines %>% dplyr::select(-centroid)
zebra_points <- rbind(zebra_points, zebra_lines)

zebra_base <- cbind(zebra_base, zebra_points)

zebra_base <- zebra_base %>% 
  select(year, zeb_msc, longitude, latitude)


#fix individual cases
zebra_base$zeb_msc[2] <- 12
zebra_base$zeb_msc[24] <- 66


```


```{r}





```


